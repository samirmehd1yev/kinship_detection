This job can be monitored from: https://grafana.c3se.chalmers.se/d/gpu-job/gpu-job?var-jobid=3151619&from=1732107554000
Using device: cuda
Model initialized with feature size: 25088
Loading pretrained weights from /cephyr/users/mehdiyev/Alvis/kinship_project/src/pretrained_models/cosface_backbone_r50.pth

Analyzing architecture differences:

Missing keys in pretrained weights:
  layer_norm.bias: torch.Size([512])
  layer_norm.weight: torch.Size([512])

Extra keys in pretrained weights:

Shape mismatches:
Missing keys after loading: 2
First few missing keys: ['layer_norm.weight', 'layer_norm.bias']
Successfully loaded pretrained weights

Evaluating on KinFaceW-I...

Testing fs relation...
Loaded 312 pairs for fs relation in KinFaceW-I

Results for fs:
accuracy: 0.5000
precision: 0.5000
recall: 1.0000
f1: 0.6667
auc: 0.7323

Testing fd relation...
Loaded 268 pairs for fd relation in KinFaceW-I

Results for fd:
accuracy: 0.5000
precision: 0.5000
recall: 1.0000
f1: 0.6667
auc: 0.6136

Testing ms relation...
Loaded 232 pairs for ms relation in KinFaceW-I

Results for ms:
accuracy: 0.4957
precision: 0.4978
recall: 0.9914
f1: 0.6628
auc: 0.6201

Testing md relation...
Loaded 254 pairs for md relation in KinFaceW-I

Results for md:
accuracy: 0.5000
precision: 0.5000
recall: 0.9764
f1: 0.6613
auc: 0.6498

Evaluating on KinFaceW-II...

Testing fs relation...
Loaded 500 pairs for fs relation in KinFaceW-II

Results for fs:
accuracy: 0.4980
precision: 0.4990
recall: 0.9960
f1: 0.6649
auc: 0.7292

Testing fd relation...
Loaded 500 pairs for fd relation in KinFaceW-II

Results for fd:
accuracy: 0.5020
precision: 0.5010
recall: 0.9880
f1: 0.6649
auc: 0.6540

Testing ms relation...
Loaded 500 pairs for ms relation in KinFaceW-II

Results for ms:
accuracy: 0.5000
precision: 0.5000
recall: 1.0000
f1: 0.6667
auc: 0.6892

Testing md relation...
Loaded 500 pairs for md relation in KinFaceW-II

Results for md:
accuracy: 0.5000
precision: 0.5000
recall: 0.9920
f1: 0.6649
auc: 0.7266

Results saved to: /cephyr/users/mehdiyev/Alvis/kinship_project/src/evaluations/results_kinfacew/evaluation_results_20241120_140127

Summary of results:
       dataset relation  accuracy  precision    recall        f1       auc
0   KinFaceW-I       fs   0.50000   0.500000  1.000000  0.666667  0.732331
1   KinFaceW-I       fd   0.50000   0.500000  1.000000  0.666667  0.613611
2   KinFaceW-I       ms   0.49569   0.497835  0.991379  0.662824  0.620095
3   KinFaceW-I       md   0.50000   0.500000  0.976378  0.661333  0.649761
4  KinFaceW-II       fs   0.49800   0.498998  0.996000  0.664887  0.729248
5  KinFaceW-II       fd   0.50200   0.501014  0.988000  0.664872  0.654048
6  KinFaceW-II       ms   0.50000   0.500000  1.000000  0.666667  0.689248
7  KinFaceW-II       md   0.50000   0.500000  0.992000  0.664879  0.726576
