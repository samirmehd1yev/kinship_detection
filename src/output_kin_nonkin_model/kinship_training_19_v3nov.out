This job can be monitored from: https://grafana.c3se.chalmers.se/d/gpu-job/gpu-job?var-jobid=3149330&from=1732048538000
Current working directory: /cephyr/users/mehdiyev/Alvis/kinship_project/src

Training Configuration:
Learning Rate: 5e-05
Face Margin: 0.3
Temperature: 0.07
Label Smoothing: 0.1
Batch Size: 128
Device: cuda
Seed: 42
Dataset initialized with 111643 samples
Dataset initialized with 25414 samples
Dataset initialized with 47238 samples
Model initialized with feature size: 25088
Loading pretrained weights from /cephyr/users/mehdiyev/Alvis/kinship_project/src/pretrained_models/cosface_backbone_r50.pth

Analyzing architecture differences:

Missing keys in pretrained weights:
  layer1.0.channel_attention.fc1.weight: torch.Size([4, 64, 1, 1])
  layer1.0.channel_attention.fc2.weight: torch.Size([64, 4, 1, 1])
  layer1.1.channel_attention.fc1.weight: torch.Size([4, 64, 1, 1])
  layer1.1.channel_attention.fc2.weight: torch.Size([64, 4, 1, 1])
  layer1.2.channel_attention.fc1.weight: torch.Size([4, 64, 1, 1])
  layer1.2.channel_attention.fc2.weight: torch.Size([64, 4, 1, 1])
  layer2.0.channel_attention.fc1.weight: torch.Size([8, 128, 1, 1])
  layer2.0.channel_attention.fc2.weight: torch.Size([128, 8, 1, 1])
  layer2.1.channel_attention.fc1.weight: torch.Size([8, 128, 1, 1])
  layer2.1.channel_attention.fc2.weight: torch.Size([128, 8, 1, 1])
  layer2.2.channel_attention.fc1.weight: torch.Size([8, 128, 1, 1])
  layer2.2.channel_attention.fc2.weight: torch.Size([128, 8, 1, 1])
  layer2.3.channel_attention.fc1.weight: torch.Size([8, 128, 1, 1])
  layer2.3.channel_attention.fc2.weight: torch.Size([128, 8, 1, 1])
  layer3.0.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.0.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.1.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.1.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.10.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.10.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.11.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.11.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.12.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.12.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.13.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.13.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.2.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.2.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.3.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.3.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.4.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.4.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.5.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.5.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.6.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.6.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.7.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.7.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.8.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.8.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer3.9.channel_attention.fc1.weight: torch.Size([16, 256, 1, 1])
  layer3.9.channel_attention.fc2.weight: torch.Size([256, 16, 1, 1])
  layer4.0.channel_attention.fc1.weight: torch.Size([32, 512, 1, 1])
  layer4.0.channel_attention.fc2.weight: torch.Size([512, 32, 1, 1])
  layer4.1.channel_attention.fc1.weight: torch.Size([32, 512, 1, 1])
  layer4.1.channel_attention.fc2.weight: torch.Size([512, 32, 1, 1])
  layer4.2.channel_attention.fc1.weight: torch.Size([32, 512, 1, 1])
  layer4.2.channel_attention.fc2.weight: torch.Size([512, 32, 1, 1])
  layer_norm.bias: torch.Size([512])
  layer_norm.weight: torch.Size([512])

Extra keys in pretrained weights:

Shape mismatches:
Successfully loaded pretrained weights

Epoch 1/10

Training Metrics:
Loss: 1.9126
Triplet Accuracy: 0.7465
Pos Kinship Accuracy: 0.6622
Neg Kinship Accuracy: 0.3397
Relationship Accuracy: 0.2250

Validation Metrics:
Loss: 1.9993
Triplet Accuracy: 0.7621
Pos Kinship Accuracy: 0.6337
Neg Kinship Accuracy: 0.4687
Relationship Accuracy: 0.1741

Epoch 2/10

Training Metrics:
Loss: 1.3835
Triplet Accuracy: 0.9215
Pos Kinship Accuracy: 0.7839
Neg Kinship Accuracy: 0.8002
Relationship Accuracy: 0.3317

Validation Metrics:
Loss: 2.4961
Triplet Accuracy: 0.6865
Pos Kinship Accuracy: 0.9911
Neg Kinship Accuracy: 0.0660
Relationship Accuracy: 0.4259

Epoch 3/10

Training Metrics:
Loss: 0.5628
Triplet Accuracy: 0.9832
Pos Kinship Accuracy: 0.9915
Neg Kinship Accuracy: 0.9992
Relationship Accuracy: 0.6371

Validation Metrics:
Loss: 3.5467
Triplet Accuracy: 0.6433
Pos Kinship Accuracy: 1.0000
Neg Kinship Accuracy: 0.0107
Relationship Accuracy: 0.5141

Epoch 4/10

Training Metrics:
Loss: 0.4859
Triplet Accuracy: 0.9906
Pos Kinship Accuracy: 0.9929
Neg Kinship Accuracy: 0.9987
Relationship Accuracy: 0.6829

Validation Metrics:
Loss: 4.2277
Triplet Accuracy: 0.6287
Pos Kinship Accuracy: 0.9991
Neg Kinship Accuracy: 0.0495
Relationship Accuracy: 0.4971

Epoch 5/10

Training Metrics:
Loss: 0.4344
Triplet Accuracy: 0.9957
Pos Kinship Accuracy: 0.9998
Neg Kinship Accuracy: 0.9998
Relationship Accuracy: 0.6938

Validation Metrics:
Loss: 4.6252
Triplet Accuracy: 0.6319
Pos Kinship Accuracy: 0.9991
Neg Kinship Accuracy: 0.0516
Relationship Accuracy: 0.4014

Epoch 6/10

Training Metrics:
Loss: 0.4245
Triplet Accuracy: 0.9971
Pos Kinship Accuracy: 1.0000
Neg Kinship Accuracy: 0.9979
Relationship Accuracy: 0.7006

Validation Metrics:
Loss: 5.2101
Triplet Accuracy: 0.6121
Pos Kinship Accuracy: 1.0000
Neg Kinship Accuracy: 0.0403
Relationship Accuracy: 0.2282

Early stopping triggered!

Running final evaluation on test set...
[1;34mwandb[0m: ðŸš€ View run [33mkinship_model_nov_19_v3_20241119_213610[0m at: [34mhttps://wandb.ai/samirmehd1yev-uppsala-universitet/kinship-verification-v3/runs/6cwjtcsu[0m
[1;34mwandb[0m: Find logs at: [1;35m../../../../../../mimer/NOBACKUP/groups/naiss2023-22-1358/samir_kinship_model/kinship_model_nov_19_v3/logs/wandb/run-20241119_213611-6cwjtcsu/logs[0m
