This job can be monitored from: https://job.c3se.chalmers.se/alvis/3287972

Dataset sizes:
Train: 123285 triplets (246570 pairs - balanced)
Val: 26403 triplets (52806 pairs - balanced)
Test: 25996 triplets (51992 pairs - balanced)
--------------------------------------------------

Model Summary:
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1         [-1, 64, 112, 112]           1,792
         OnnxPReLU-2         [-1, 64, 112, 112]               0
       BatchNorm2d-3         [-1, 64, 112, 112]             128
            Conv2d-4         [-1, 64, 112, 112]          36,928
         OnnxPReLU-5         [-1, 64, 112, 112]               0
            Conv2d-6           [-1, 64, 56, 56]          36,928
            Conv2d-7           [-1, 64, 56, 56]           4,160
OnnxBinaryMathOperation-8           [-1, 64, 56, 56]               0
       BatchNorm2d-9           [-1, 64, 56, 56]             128
           Conv2d-10           [-1, 64, 56, 56]          36,928
        OnnxPReLU-11           [-1, 64, 56, 56]               0
           Conv2d-12           [-1, 64, 56, 56]          36,928
OnnxBinaryMathOperation-13           [-1, 64, 56, 56]               0
      BatchNorm2d-14           [-1, 64, 56, 56]             128
           Conv2d-15           [-1, 64, 56, 56]          36,928
        OnnxPReLU-16           [-1, 64, 56, 56]               0
           Conv2d-17           [-1, 64, 56, 56]          36,928
OnnxBinaryMathOperation-18           [-1, 64, 56, 56]               0
      BatchNorm2d-19           [-1, 64, 56, 56]             128
           Conv2d-20          [-1, 128, 56, 56]          73,856
        OnnxPReLU-21          [-1, 128, 56, 56]               0
           Conv2d-22          [-1, 128, 28, 28]         147,584
           Conv2d-23          [-1, 128, 28, 28]           8,320
OnnxBinaryMathOperation-24          [-1, 128, 28, 28]               0
      BatchNorm2d-25          [-1, 128, 28, 28]             256
           Conv2d-26          [-1, 128, 28, 28]         147,584
        OnnxPReLU-27          [-1, 128, 28, 28]               0
           Conv2d-28          [-1, 128, 28, 28]         147,584
OnnxBinaryMathOperation-29          [-1, 128, 28, 28]               0
      BatchNorm2d-30          [-1, 128, 28, 28]             256
           Conv2d-31          [-1, 128, 28, 28]         147,584
        OnnxPReLU-32          [-1, 128, 28, 28]               0
           Conv2d-33          [-1, 128, 28, 28]         147,584
OnnxBinaryMathOperation-34          [-1, 128, 28, 28]               0
      BatchNorm2d-35          [-1, 128, 28, 28]             256
           Conv2d-36          [-1, 128, 28, 28]         147,584
        OnnxPReLU-37          [-1, 128, 28, 28]               0
           Conv2d-38          [-1, 128, 28, 28]         147,584
OnnxBinaryMathOperation-39          [-1, 128, 28, 28]               0
      BatchNorm2d-40          [-1, 128, 28, 28]             256
           Conv2d-41          [-1, 256, 28, 28]         295,168
        OnnxPReLU-42          [-1, 256, 28, 28]               0
           Conv2d-43          [-1, 256, 14, 14]         590,080
           Conv2d-44          [-1, 256, 14, 14]          33,024
OnnxBinaryMathOperation-45          [-1, 256, 14, 14]               0
      BatchNorm2d-46          [-1, 256, 14, 14]             512
           Conv2d-47          [-1, 256, 14, 14]         590,080
        OnnxPReLU-48          [-1, 256, 14, 14]               0
           Conv2d-49          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-50          [-1, 256, 14, 14]               0
      BatchNorm2d-51          [-1, 256, 14, 14]             512
           Conv2d-52          [-1, 256, 14, 14]         590,080
        OnnxPReLU-53          [-1, 256, 14, 14]               0
           Conv2d-54          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-55          [-1, 256, 14, 14]               0
      BatchNorm2d-56          [-1, 256, 14, 14]             512
           Conv2d-57          [-1, 256, 14, 14]         590,080
        OnnxPReLU-58          [-1, 256, 14, 14]               0
           Conv2d-59          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-60          [-1, 256, 14, 14]               0
      BatchNorm2d-61          [-1, 256, 14, 14]             512
           Conv2d-62          [-1, 256, 14, 14]         590,080
        OnnxPReLU-63          [-1, 256, 14, 14]               0
           Conv2d-64          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-65          [-1, 256, 14, 14]               0
      BatchNorm2d-66          [-1, 256, 14, 14]             512
           Conv2d-67          [-1, 256, 14, 14]         590,080
        OnnxPReLU-68          [-1, 256, 14, 14]               0
           Conv2d-69          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-70          [-1, 256, 14, 14]               0
      BatchNorm2d-71          [-1, 256, 14, 14]             512
           Conv2d-72          [-1, 256, 14, 14]         590,080
        OnnxPReLU-73          [-1, 256, 14, 14]               0
           Conv2d-74          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-75          [-1, 256, 14, 14]               0
      BatchNorm2d-76          [-1, 256, 14, 14]             512
           Conv2d-77          [-1, 256, 14, 14]         590,080
        OnnxPReLU-78          [-1, 256, 14, 14]               0
           Conv2d-79          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-80          [-1, 256, 14, 14]               0
      BatchNorm2d-81          [-1, 256, 14, 14]             512
           Conv2d-82          [-1, 256, 14, 14]         590,080
        OnnxPReLU-83          [-1, 256, 14, 14]               0
           Conv2d-84          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-85          [-1, 256, 14, 14]               0
      BatchNorm2d-86          [-1, 256, 14, 14]             512
           Conv2d-87          [-1, 256, 14, 14]         590,080
        OnnxPReLU-88          [-1, 256, 14, 14]               0
           Conv2d-89          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-90          [-1, 256, 14, 14]               0
      BatchNorm2d-91          [-1, 256, 14, 14]             512
           Conv2d-92          [-1, 256, 14, 14]         590,080
        OnnxPReLU-93          [-1, 256, 14, 14]               0
           Conv2d-94          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-95          [-1, 256, 14, 14]               0
      BatchNorm2d-96          [-1, 256, 14, 14]             512
           Conv2d-97          [-1, 256, 14, 14]         590,080
        OnnxPReLU-98          [-1, 256, 14, 14]               0
           Conv2d-99          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-100          [-1, 256, 14, 14]               0
     BatchNorm2d-101          [-1, 256, 14, 14]             512
          Conv2d-102          [-1, 256, 14, 14]         590,080
       OnnxPReLU-103          [-1, 256, 14, 14]               0
          Conv2d-104          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-105          [-1, 256, 14, 14]               0
     BatchNorm2d-106          [-1, 256, 14, 14]             512
          Conv2d-107          [-1, 256, 14, 14]         590,080
       OnnxPReLU-108          [-1, 256, 14, 14]               0
          Conv2d-109          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-110          [-1, 256, 14, 14]               0
     BatchNorm2d-111          [-1, 256, 14, 14]             512
          Conv2d-112          [-1, 512, 14, 14]       1,180,160
       OnnxPReLU-113          [-1, 512, 14, 14]               0
          Conv2d-114            [-1, 512, 7, 7]       2,359,808
          Conv2d-115            [-1, 512, 7, 7]         131,584
OnnxBinaryMathOperation-116            [-1, 512, 7, 7]               0
     BatchNorm2d-117            [-1, 512, 7, 7]           1,024
          Conv2d-118            [-1, 512, 7, 7]       2,359,808
       OnnxPReLU-119            [-1, 512, 7, 7]               0
          Conv2d-120            [-1, 512, 7, 7]       2,359,808
OnnxBinaryMathOperation-121            [-1, 512, 7, 7]               0
     BatchNorm2d-122            [-1, 512, 7, 7]           1,024
          Conv2d-123            [-1, 512, 7, 7]       2,359,808
       OnnxPReLU-124            [-1, 512, 7, 7]               0
          Conv2d-125            [-1, 512, 7, 7]       2,359,808
OnnxBinaryMathOperation-126            [-1, 512, 7, 7]               0
     BatchNorm2d-127            [-1, 512, 7, 7]           1,024
         Flatten-128                [-1, 25088]               0
          Linear-129                  [-1, 512]      12,845,568
     BatchNorm1d-130                  [-1, 512]           1,024
 GraphModuleImpl-131                  [-1, 512]               0
          Conv2d-132         [-1, 64, 112, 112]           1,792
       OnnxPReLU-133         [-1, 64, 112, 112]               0
     BatchNorm2d-134         [-1, 64, 112, 112]             128
          Conv2d-135         [-1, 64, 112, 112]          36,928
       OnnxPReLU-136         [-1, 64, 112, 112]               0
          Conv2d-137           [-1, 64, 56, 56]          36,928
          Conv2d-138           [-1, 64, 56, 56]           4,160
OnnxBinaryMathOperation-139           [-1, 64, 56, 56]               0
     BatchNorm2d-140           [-1, 64, 56, 56]             128
          Conv2d-141           [-1, 64, 56, 56]          36,928
       OnnxPReLU-142           [-1, 64, 56, 56]               0
          Conv2d-143           [-1, 64, 56, 56]          36,928
OnnxBinaryMathOperation-144           [-1, 64, 56, 56]               0
     BatchNorm2d-145           [-1, 64, 56, 56]             128
          Conv2d-146           [-1, 64, 56, 56]          36,928
       OnnxPReLU-147           [-1, 64, 56, 56]               0
          Conv2d-148           [-1, 64, 56, 56]          36,928
OnnxBinaryMathOperation-149           [-1, 64, 56, 56]               0
     BatchNorm2d-150           [-1, 64, 56, 56]             128
          Conv2d-151          [-1, 128, 56, 56]          73,856
       OnnxPReLU-152          [-1, 128, 56, 56]               0
          Conv2d-153          [-1, 128, 28, 28]         147,584
          Conv2d-154          [-1, 128, 28, 28]           8,320
OnnxBinaryMathOperation-155          [-1, 128, 28, 28]               0
     BatchNorm2d-156          [-1, 128, 28, 28]             256
          Conv2d-157          [-1, 128, 28, 28]         147,584
       OnnxPReLU-158          [-1, 128, 28, 28]               0
          Conv2d-159          [-1, 128, 28, 28]         147,584
OnnxBinaryMathOperation-160          [-1, 128, 28, 28]               0
     BatchNorm2d-161          [-1, 128, 28, 28]             256
          Conv2d-162          [-1, 128, 28, 28]         147,584
       OnnxPReLU-163          [-1, 128, 28, 28]               0
          Conv2d-164          [-1, 128, 28, 28]         147,584
OnnxBinaryMathOperation-165          [-1, 128, 28, 28]               0
     BatchNorm2d-166          [-1, 128, 28, 28]             256
          Conv2d-167          [-1, 128, 28, 28]         147,584
       OnnxPReLU-168          [-1, 128, 28, 28]               0
          Conv2d-169          [-1, 128, 28, 28]         147,584
OnnxBinaryMathOperation-170          [-1, 128, 28, 28]               0
     BatchNorm2d-171          [-1, 128, 28, 28]             256
          Conv2d-172          [-1, 256, 28, 28]         295,168
       OnnxPReLU-173          [-1, 256, 28, 28]               0
          Conv2d-174          [-1, 256, 14, 14]         590,080
          Conv2d-175          [-1, 256, 14, 14]          33,024
OnnxBinaryMathOperation-176          [-1, 256, 14, 14]               0
     BatchNorm2d-177          [-1, 256, 14, 14]             512
          Conv2d-178          [-1, 256, 14, 14]         590,080
       OnnxPReLU-179          [-1, 256, 14, 14]               0
          Conv2d-180          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-181          [-1, 256, 14, 14]               0
     BatchNorm2d-182          [-1, 256, 14, 14]             512
          Conv2d-183          [-1, 256, 14, 14]         590,080
       OnnxPReLU-184          [-1, 256, 14, 14]               0
          Conv2d-185          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-186          [-1, 256, 14, 14]               0
     BatchNorm2d-187          [-1, 256, 14, 14]             512
          Conv2d-188          [-1, 256, 14, 14]         590,080
       OnnxPReLU-189          [-1, 256, 14, 14]               0
          Conv2d-190          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-191          [-1, 256, 14, 14]               0
     BatchNorm2d-192          [-1, 256, 14, 14]             512
          Conv2d-193          [-1, 256, 14, 14]         590,080
       OnnxPReLU-194          [-1, 256, 14, 14]               0
          Conv2d-195          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-196          [-1, 256, 14, 14]               0
     BatchNorm2d-197          [-1, 256, 14, 14]             512
          Conv2d-198          [-1, 256, 14, 14]         590,080
       OnnxPReLU-199          [-1, 256, 14, 14]               0
          Conv2d-200          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-201          [-1, 256, 14, 14]               0
     BatchNorm2d-202          [-1, 256, 14, 14]             512
          Conv2d-203          [-1, 256, 14, 14]         590,080
       OnnxPReLU-204          [-1, 256, 14, 14]               0
          Conv2d-205          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-206          [-1, 256, 14, 14]               0
     BatchNorm2d-207          [-1, 256, 14, 14]             512
          Conv2d-208          [-1, 256, 14, 14]         590,080
       OnnxPReLU-209          [-1, 256, 14, 14]               0
          Conv2d-210          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-211          [-1, 256, 14, 14]               0
     BatchNorm2d-212          [-1, 256, 14, 14]             512
          Conv2d-213          [-1, 256, 14, 14]         590,080
       OnnxPReLU-214          [-1, 256, 14, 14]               0
          Conv2d-215          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-216          [-1, 256, 14, 14]               0
     BatchNorm2d-217          [-1, 256, 14, 14]             512
          Conv2d-218          [-1, 256, 14, 14]         590,080
       OnnxPReLU-219          [-1, 256, 14, 14]               0
          Conv2d-220          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-221          [-1, 256, 14, 14]               0
     BatchNorm2d-222          [-1, 256, 14, 14]             512
          Conv2d-223          [-1, 256, 14, 14]         590,080
       OnnxPReLU-224          [-1, 256, 14, 14]               0
          Conv2d-225          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-226          [-1, 256, 14, 14]               0
     BatchNorm2d-227          [-1, 256, 14, 14]             512
          Conv2d-228          [-1, 256, 14, 14]         590,080
       OnnxPReLU-229          [-1, 256, 14, 14]               0
          Conv2d-230          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-231          [-1, 256, 14, 14]               0
     BatchNorm2d-232          [-1, 256, 14, 14]             512
          Conv2d-233          [-1, 256, 14, 14]         590,080
       OnnxPReLU-234          [-1, 256, 14, 14]               0
          Conv2d-235          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-236          [-1, 256, 14, 14]               0
     BatchNorm2d-237          [-1, 256, 14, 14]             512
          Conv2d-238          [-1, 256, 14, 14]         590,080
       OnnxPReLU-239          [-1, 256, 14, 14]               0
          Conv2d-240          [-1, 256, 14, 14]         590,080
OnnxBinaryMathOperation-241          [-1, 256, 14, 14]               0
     BatchNorm2d-242          [-1, 256, 14, 14]             512
          Conv2d-243          [-1, 512, 14, 14]       1,180,160
       OnnxPReLU-244          [-1, 512, 14, 14]               0
          Conv2d-245            [-1, 512, 7, 7]       2,359,808
          Conv2d-246            [-1, 512, 7, 7]         131,584
OnnxBinaryMathOperation-247            [-1, 512, 7, 7]               0
     BatchNorm2d-248            [-1, 512, 7, 7]           1,024
          Conv2d-249            [-1, 512, 7, 7]       2,359,808
       OnnxPReLU-250            [-1, 512, 7, 7]               0
          Conv2d-251            [-1, 512, 7, 7]       2,359,808
OnnxBinaryMathOperation-252            [-1, 512, 7, 7]               0
     BatchNorm2d-253            [-1, 512, 7, 7]           1,024
          Conv2d-254            [-1, 512, 7, 7]       2,359,808
       OnnxPReLU-255            [-1, 512, 7, 7]               0
          Conv2d-256            [-1, 512, 7, 7]       2,359,808
OnnxBinaryMathOperation-257            [-1, 512, 7, 7]               0
     BatchNorm2d-258            [-1, 512, 7, 7]           1,024
         Flatten-259                [-1, 25088]               0
          Linear-260                  [-1, 512]      12,845,568
     BatchNorm1d-261                  [-1, 512]           1,024
 GraphModuleImpl-262                  [-1, 512]               0
     BatchNorm1d-263                  [-1, 512]           1,024
         Dropout-264                  [-1, 512]               0
     BatchNorm1d-265                  [-1, 512]           1,024
         Dropout-266                  [-1, 512]               0
================================================================
Total params: 87,146,624
Trainable params: 87,146,624
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 5402.25
Forward/backward pass size (MB): 213.27
Params size (MB): 332.44
Estimated Total Size (MB): 5947.95
----------------------------------------------------------------
--------------------------------------------------

Evaluating model before training:

Initial Performance:
Validation - Accuracy: 0.7793, AUC: 0.8585, Threshold: 0.0800
Test - Accuracy: 0.7539, AUC: 0.8285, Threshold: 0.0800

Epoch 1 Summary:
Training - Loss: 14.3129, Acc: 0.7432, Threshold: 0.0600
Validation - Acc: 0.7856, AUC: 0.8622, Threshold: 0.0600
Saved new best model with validation accuracy: 0.7856

Epoch 2 Summary:
Training - Loss: 14.1682, Acc: 0.7653, Threshold: 0.0600
Validation - Acc: 0.7843, AUC: 0.8619, Threshold: 0.0600

Epoch 3 Summary:
Training - Loss: 13.6790, Acc: 0.7683, Threshold: 0.0700
Validation - Acc: 0.7701, AUC: 0.8425, Threshold: 0.0700

Epoch 4 Summary:
Training - Loss: 12.7702, Acc: 0.7524, Threshold: 0.1200
Validation - Acc: 0.7041, AUC: 0.7398, Threshold: 0.1200

Epoch 5 Summary:
Training - Loss: 11.7994, Acc: 0.6978, Threshold: 0.1700
Validation - Acc: 0.6315, AUC: 0.6533, Threshold: 0.1700
